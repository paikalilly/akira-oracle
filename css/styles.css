:root { --w: min(92vw, 360px); --radius: 16px; }
* { box-sizing: border-box; }
body { margin:0; font-family: system-ui, sans-serif; background:#0b0b0c; color:#eee; }

.topbar { display:flex; justify-content:space-between; align-items:center; padding:10px 14px; }
.topbar h1 { font-size:1rem; font-weight:600; margin:0; }
.controls { display:flex; gap:10px; align-items:center; }
.toggle { display:flex; gap:6px; align-items:center; font-size:.9rem; }
#refreshBtn { cursor:pointer; font-size:1rem; padding:6px 10px; border-radius:10px; border:1px solid #333; background:#151516; color:#ccc; }
.counter { opacity:.8; font-size:.85rem; }

main { display:grid; gap:10px; padding:10px; }

/* Carousel */
.carousel {
  position:relative;
  height: min(78vh, calc(92vw * 5/3));   /* was calc(min(92vw,360px)*5/3) */
  overflow:hidden;
}
.carousel__track { position:absolute; inset:0; touch-action:pan-y; }

/* Cards (coverflow layout) */
.card { will-change: transform; }

.card {
  position:absolute; left:50%; top:50%;
  width:min(92vw, 360px); aspect-ratio:3/5;
  transform: translate(-50%,-50%);
  border-radius:var(--radius);
  cursor:pointer;
  transition: transform .28s ease, opacity .2s ease, box-shadow .28s ease;
  perspective:1200px; /* needed for 3D flip */
}
.card.is-outside { opacity:0; pointer-events:none; }
.card.is-center .card__face { box-shadow:0 16px 40px rgba(0,0,0,.6) }

/* Flip — robust via inner wrapper */
.card__inner {
  position:absolute; inset:0;
  transform-style:preserve-3d;
  transition: transform .6s ease;
  border-radius:var(--radius);
}
.card__face {
  position:absolute; inset:0;
  border-radius:var(--radius);
  overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.45);
  /* Default: hide backface */
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}
.card__face--back  {
  transform: rotateY(0);
  background:#111;
}
.card__face--front {
  transform: rotateY(180deg) translateZ(1px); /* translateZ(1px) helps z-fighting */
  pointer-events:auto;
  /* Make front face visible when it's rotated into view */
  backface-visibility: visible;
  -webkit-backface-visibility: visible;
}
.card.card--flipped .card__inner {
  transform: rotateY(180deg);
}

/* Media */
.card__media { width:100%; height:100%; object-fit:cover; display:block; }

/* Overlay centered with soft vignette */
.card__overlay {
  position:absolute; inset:0;
  /* subtle vignette so mid-card text reads over bright images */
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,.55) 0%, rgba(0,0,0,.35) 35%, rgba(0,0,0,.1) 60%, rgba(0,0,0,0) 80%);
  display:flex; align-items:center; justify-content:center;
  opacity:0; pointer-events:none; transition: opacity .35s ease;
}
.card__overlay.show { opacity:1; pointer-events:auto; }

.overlay__text {
  color:#fff; width:86%; max-width:28rem;
  text-align:center;
  font-family: "Cormorant Garamond", serif;
  font-weight:600; letter-spacing:.2px;
  line-height:1.2;
  text-shadow: 0 2px 8px rgba(0,0,0,.6);
  transform: translateY(6px); transition: transform .35s ease;
}
.card__overlay.show .overlay__text { transform: translateY(0); }

.overlay__title { margin:0; font-size:1.35rem; }
.overlay__prompt { display:none; } /* you’re not using prompts */
/* top-right link icon */
.overlay__link {
  position:absolute;
  top:10px; right:10px;
  color:#fff;
  opacity:0.85;
  transition:opacity .25s;
}
.overlay__link:hover { opacity:1; }
.overlay__link svg { display:block; }



/* Motion accessibility */
@media (prefers-reduced-motion: reduce) {
  .card__inner,
  .card,
  .card__overlay,
  .overlay__text { transition: none !important; }
}

@media (max-width: 480px) {
  .card.is-center .card__face { box-shadow:0 10px 26px rgba(0,0,0,.55) }
  .card__face { box-shadow:0 6px 18px rgba(0,0,0,.40) }
}

/* Ensure correct 3D painting order across browsers */
/* .card { transform-style: preserve-3d; perspective: 1200px; } Removed this as it's now in .card directly */

/* Hide backfaces everywhere, including the <img> - This is now more specific */
/* .card__face, .card__media { backface-visibility: hidden; -webkit-backface-visibility: hidden; } Removed */

/* Put the front face slightly in front to avoid z-fighting */
/* .card__face--front { transform: rotateY(180deg) translateZ(1px); } Integrated into the main .card__face--front block */

/* The flip uses the inner wrapper; keep it 3D */
/* .card__inner { transform-style: preserve-3d; transition: transform .6s ease; } Integrated into the main .card__inner block */
/* .card.card--flipped .card__inner { transform: rotateY(180deg); } Integrated into the main .card.card--flipped .card__inner block */

/* (Optional) Safari/WebKit quirk guard */
@supports (-webkit-hyphens: none) {
  .card__face, .card__media { -webkit-backface-visibility: hidden; }
}
